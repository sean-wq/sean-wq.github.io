<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta name="description" content="‘’">
<meta property="og:type" content="website">
<meta property="og:title" content="Sean&#39;s Blog">
<meta property="og:url" content="https://sean-wq.github.io/index.html">
<meta property="og:site_name" content="Sean&#39;s Blog">
<meta property="og:description" content="‘’">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Sean">
<meta name="twitter:card" content="summary"><title>Sean's Blog</title><link ref="canonical" href="https://sean-wq.github.io/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">标签</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">搜索</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Sean's Blog</div><div class="header-banner-info__subtitle">万物皆有裂痕，那是光照进来的地方</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/JS%E9%80%86%E5%90%91-JS%E6%96%87%E4%BB%B6%E6%9B%BF%E6%8D%A2/">JS逆向-JS文件替换重写</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">360</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h4 id="JS逆向-JS文件替换重写"   >
          <a href="#JS逆向-JS文件替换重写" class="heading-link"><i class="fas fa-link"></i></a><a href="#JS逆向-JS文件替换重写" class="headerlink" title="JS逆向-JS文件替换重写"></a>JS逆向-JS文件替换重写</h4>
      <p>为了方便调试查看某个变量变化情况，替换原来的代码，加上一些调试条件更容易找到，以下的步骤：</p>
<p><strong>1.打开DevTools</strong></p>
<p><strong>2.Sources-Overrides-新建一个文件夹</strong></p>
<p><strong>3.Sources-Page-调试某个JS文件，右键Save AS到文件夹里面</strong></p>
<p><strong>4.Enable Local Overrides启动</strong></p>
<p>以下是部分替换逻辑</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">eu = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 1. 保存原始的 set 函数</span></span><br><span class="line">    <span class="keyword">var</span> _originalSet = er.setSessionList;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 返回一个新的函数作为替身</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">newData</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 3. 只有当写入的数据不为空时，才断点（过滤掉初始化时的空数据）</span></span><br><span class="line">        <span class="keyword">if</span> (newData &amp;&amp; (<span class="built_in">Array</span>.isArray(newData) ? newData.length &gt; <span class="number">0</span> : <span class="literal">true</span>)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;%c[抓到了] 数据源头正在写入:&#x27;</span>, <span class="string">&#x27;color:red; font-size:16px;&#x27;</span>, newData);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ------------------------------------------------</span></span><br><span class="line">            <span class="keyword">debugger</span>; <span class="comment">// &lt;--- 关键！看右侧 Call Stack (调用栈)</span></span><br><span class="line">            <span class="comment">// ------------------------------------------------</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. 执行原始逻辑，保证页面不崩</span></span><br><span class="line">        <span class="keyword">return</span> _originalSet.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)(),</span><br><span class="line"></span><br><span class="line">ec = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 1. 保存原始的 set 函数</span></span><br><span class="line">    <span class="keyword">var</span> _originalSet = er.setSessionList;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 返回一个新的函数作为替身</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">newData</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 3. 只有当写入的数据不为空时，才断点（过滤掉初始化时的空数据）</span></span><br><span class="line">        <span class="keyword">if</span> (newData &amp;&amp; (<span class="built_in">Array</span>.isArray(newData) ? newData.length &gt; <span class="number">0</span> : <span class="literal">true</span>)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;%c[抓到了] 数据源头正在写入:&#x27;</span>, <span class="string">&#x27;color:red; font-size:16px;&#x27;</span>, newData);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ------------------------------------------------</span></span><br><span class="line">           <span class="comment">// debugger; // &lt;--- 关键！看右侧 Call Stack (调用栈)</span></span><br><span class="line">            <span class="comment">// ------------------------------------------------</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. 执行原始逻辑，保证页面不崩</span></span><br><span class="line">        <span class="keyword">return</span> _originalSet.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/Excel%E8%A1%A8%E5%A4%84%E7%90%86%E6%96%B0%E8%A1%8C%E6%8F%92%E5%85%A5%E9%80%9A%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95/">Excel表处理新行插入通用的方法</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">529</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>Excel表处理新行插入，并且底部有数据的时候，适用的方法</p>
<p>openpyxl库中可以使用的一些方法</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">def copy_row_with_style_formula_merge_cells(ws, src_row, target_row):</span><br><span class="line">    max_col &#x3D; ws.max_column</span><br><span class="line">    # print(f&quot;目前插入的行有：&#123;target_row&#125;&quot;)</span><br><span class="line">    # if merge_sheet_name &#x3D;&#x3D; &#39;申报要素&#39;:</span><br><span class="line">    #     ws.insert_rows(src_row)</span><br><span class="line">    # else:</span><br><span class="line">    ws.insert_rows(target_row)</span><br><span class="line">    #行高一致</span><br><span class="line">    if ws.row_dimensions[src_row].height:</span><br><span class="line">        ws.row_dimensions[target_row].height &#x3D; ws.row_dimensions[src_row].height</span><br><span class="line"></span><br><span class="line">    for col in range(1, max_col + 1):</span><br><span class="line">        src_cell &#x3D; ws.cell(row&#x3D;src_row, column&#x3D;col)</span><br><span class="line">        dst_cell &#x3D; ws.cell(row&#x3D;target_row, column&#x3D;col)</span><br><span class="line"></span><br><span class="line">        # 跳过 MergedCell 类型的单元格，因为它们的 value 属性是只读的</span><br><span class="line">        if not isinstance(dst_cell, MergedCell):</span><br><span class="line">            # 检查是否为公式单元格</span><br><span class="line">            if src_cell.data_type &#x3D;&#x3D; &#39;f&#39; and src_cell.value:</span><br><span class="line">                # 计算行偏移量</span><br><span class="line">                offset &#x3D; target_row - src_row</span><br><span class="line">                formula &#x3D; src_cell.value</span><br><span class="line"></span><br><span class="line">                # 使用正则表达式查找并替换公式中的行引用</span><br><span class="line">                # 匹配单元格引用，如 A1, B23, $C$5, $D10, E$15 等</span><br><span class="line">                def adjust_cell_reference(match):</span><br><span class="line">                    col_ref &#x3D; match.group(1)  # 列引用（可能包含$）</span><br><span class="line">                    row_ref &#x3D; match.group(2)  # 行号</span><br><span class="line"></span><br><span class="line">                    # 如果行号前有$符号（绝对引用），则不调整</span><br><span class="line">                    if &#39;$&#39; in match.group(0) and match.group(0).index(&#39;$&#39;) &lt; match.group(0).index(row_ref):</span><br><span class="line">                        return match.group(0)</span><br><span class="line"></span><br><span class="line">                    # 调整相对行引用</span><br><span class="line">                    new_row &#x3D; int(row_ref) + offset</span><br><span class="line">                    return f&quot;&#123;col_ref&#125;&#123;new_row&#125;&quot;</span><br><span class="line"></span><br><span class="line">                # 匹配列引用和行号：$?[A-Z]+\$?(\d+)</span><br><span class="line">                # 分组1: $?[A-Z]+ (列引用，可能包含$)</span><br><span class="line">                # 分组2: \d+ (行号)</span><br><span class="line">                adjusted_formula &#x3D; re.sub(r&#39;(\$?[A-Z]+)\$?(\d+)&#39;, adjust_cell_reference, formula)</span><br><span class="line">                dst_cell.value &#x3D; adjusted_formula</span><br><span class="line">            else:</span><br><span class="line">                # 非公式单元格，直接复制值</span><br><span class="line">                dst_cell.value &#x3D; src_cell.value</span><br><span class="line"></span><br><span class="line">        if src_cell.has_style:</span><br><span class="line">            dst_cell._style &#x3D; copy.copy(src_cell._style)</span><br><span class="line"></span><br><span class="line">        if src_cell.hyperlink:</span><br><span class="line">            dst_cell._hyperlink &#x3D; copy.copy(src_cell.hyperlink)</span><br><span class="line"></span><br><span class="line">        if src_cell.comment:</span><br><span class="line">            dst_cell.comment &#x3D; copy.copy(src_cell.comment)</span><br><span class="line"></span><br><span class="line">        for merged_range in list(ws.merged_cells.ranges):</span><br><span class="line">            # print(f&quot;merged_range: &#123;merged_range&#125;&quot;)</span><br><span class="line">            min_row, min_col, max_row, max_col &#x3D; merged_range.min_row, merged_range.min_col, merged_range.max_row, merged_range.max_col</span><br><span class="line">            # 判断该行是否在合并区域中</span><br><span class="line">            if min_row &lt;&#x3D; src_row &lt;&#x3D; max_row:</span><br><span class="line">                offset &#x3D; target_row - src_row</span><br><span class="line">                new_range &#x3D; (</span><br><span class="line">                    ws.cell(row&#x3D;min_row + offset, column&#x3D;min_col).coordinate</span><br><span class="line">                    + &quot;:&quot; +</span><br><span class="line">                    ws.cell(row&#x3D;max_row + offset, column&#x3D;max_col).coordinate</span><br><span class="line">                )</span><br><span class="line">                ws.merge_cells(new_range)</span><br><span class="line"></span><br><span class="line">    # 复制行高</span><br><span class="line">    if ws.row_dimensions[src_row].height:</span><br><span class="line">        ws.row_dimensions[target_row].height &#x3D; ws.row_dimensions[src_row].height)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>此方法适合复制行的样式以及公式等，比较通用，直接复制即可用，现在记录下，后续可以直接使用</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/SQL%E9%81%87%E5%88%B0%E7%9A%84%E5%A4%9A%E6%AC%A1%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C/">SQL遇到的多次计算结果</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">594</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="2025-10-15笔记遇到的SQL问题"   >
          <a href="#2025-10-15笔记遇到的SQL问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#2025-10-15笔记遇到的SQL问题" class="headerlink" title="2025-10-15笔记遇到的SQL问题"></a>2025-10-15笔记遇到的SQL问题</h3>
      <p>MySQL中需要注意update时连续引用值赋值到别的字段，可能会造成重复计算的情况</p>
<p>比如:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">String updateWeightedAmount = <span class="string">&quot;update amz_data_analysis_turnover_mskulist &quot;</span> + <span class="string">&quot;set sales_amount = case &quot;</span> +</span><br><span class="line">     <span class="string">&quot;WHEN sales_amount REGEXP &#x27;^\\\\(&#x27; THEN concat(REGEXP_SUBSTR(sales_amount,&#x27;[^0-9.-]&#x27;), -1 * CAST(REPLACE(REGEXP_REPLACE(sales_amount,&#x27;[^0-9.-]&#x27;,&#x27;&#x27;),&#x27; &#x27;,&#x27;&#x27;) AS DECIMAL(10,2)) * score ,2) &quot;</span></span><br><span class="line">    + <span class="string">&quot;ELSE concat(REGEXP_SUBSTR(sales_amount,&#x27;[^0-9.-]&#x27;), CAST(REPLACE(REGEXP_REPLACE(sales_amount,&#x27;[^0-9.-]&#x27;,&#x27;&#x27;),&#x27; &#x27;,&#x27;&#x27;) AS DECIMAL(10,2)) * score,2) &quot;</span> + <span class="string">&quot;END,&quot;</span></span><br><span class="line">    + <span class="string">&quot;gross_profit = case &quot;</span> + <span class="string">&quot;WHEN gross_profit REGEXP &#x27;^\\\\(&#x27; THEN concat(REGEXP_SUBSTR(gross_profit,&#x27;[^0-9.-]&#x27;), -1 * CAST(REPLACE(REGEXP_REPLACE(gross_profit,&#x27;[^0-9.-]&#x27;,&#x27;&#x27;),&#x27; &#x27;,&#x27;&#x27;) AS DECIMAL(10,2)) * score) &quot;</span></span><br><span class="line">    + <span class="string">&quot;ELSE concat(REGEXP_SUBSTR(gross_profit,&#x27;[^0-9.-]&#x27;), CAST(REPLACE(REGEXP_REPLACE(gross_profit,&#x27;[^0-9.-]&#x27;,&#x27;&#x27;),&#x27; &#x27;,&#x27;&#x27;) AS DECIMAL(10,2)) * score ) &quot;</span> + <span class="string">&quot;END,&quot;</span></span><br><span class="line">    + <span class="string">&quot;sales_amount_format = case &quot;</span></span><br><span class="line">    + <span class="string">&quot;WHEN sales_amount REGEXP &#x27;^\\\\(&#x27; THEN -1 * CAST(REPLACE(REGEXP_REPLACE(sales_amount,&#x27;[^0-9.-]&#x27;,&#x27;&#x27;),&#x27; &#x27;,&#x27;&#x27;) AS DECIMAL(10,2)) * score &quot;</span></span><br><span class="line">    + <span class="string">&quot;ELSE CAST(REPLACE(REGEXP_REPLACE(sales_amount,&#x27;[^0-9.-]&#x27;,&#x27;&#x27;),&#x27; &#x27;,&#x27;&#x27;) AS DECIMAL(10,2)) * score &quot;</span> +<span class="string">&quot;END,&quot;</span></span><br><span class="line">    + <span class="string">&quot;gross_profit_format = case &quot;</span> + <span class="string">&quot;WHEN gross_profit REGEXP &#x27;^\\\\(&#x27; THEN -1 * CAST(REPLACE(REGEXP_REPLACE(gross_profit,&#x27;[^0-9.-]&#x27;,&#x27;&#x27;),&#x27; &#x27;,&#x27;&#x27;) AS DECIMAL(10,2)) * score &quot;</span></span><br><span class="line">    + <span class="string">&quot;ELSE CAST(REPLACE(REGEXP_REPLACE(gross_profit,&#x27;[^0-9.-]&#x27;,&#x27;&#x27;),&#x27; &#x27;,&#x27;&#x27;) AS DECIMAL(10,2)) * score &quot;</span> + <span class="string">&quot;END &quot;</span></span><br><span class="line">    + <span class="string">&quot;where DATE(created_at) = CURDATE()&quot;</span>;</span><br></pre></td></tr></table></div></figure>

<p>gross_profit_format字段就得到了gross_profit乘以两次score的值</p>
<p>以下有两种办法，一种是update两次，一种是用子查询保存结果后再update</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">String updateAllFields =</span><br><span class="line">    <span class="string">&quot;UPDATE amz_data_analysis_turnover_mskulist AS t &quot;</span> +</span><br><span class="line">    <span class="string">&quot;JOIN ( &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  SELECT id, &quot;</span> +</span><br><span class="line">    <span class="string">&quot;         CAST(REPLACE(REGEXP_REPLACE(sales_amount, &#x27;[^0-9.-]&#x27;, &#x27;&#x27;), &#x27; &#x27;, &#x27;&#x27;) AS DECIMAL(10,2)) AS sa_value, &quot;</span> +</span><br><span class="line">    <span class="string">&quot;         CAST(REPLACE(REGEXP_REPLACE(gross_profit, &#x27;[^0-9.-]&#x27;, &#x27;&#x27;), &#x27; &#x27;, &#x27;&#x27;) AS DECIMAL(10,2)) AS gp_value, &quot;</span> +</span><br><span class="line">    <span class="string">&quot;         sales_amount, gross_profit &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  FROM amz_data_analysis_turnover_mskulist &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  WHERE DATE(created_at) = CURDATE() &quot;</span> +</span><br><span class="line">    <span class="string">&quot;) AS orig ON t.id = orig.id &quot;</span> +</span><br><span class="line">    <span class="string">&quot;SET &quot;</span> +</span><br><span class="line">    <span class="string">&quot;t.sales_amount = CASE &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  WHEN orig.sales_amount REGEXP &#x27;^\\\\(&#x27; THEN CONCAT(REGEXP_SUBSTR(orig.sales_amount, &#x27;[^0-9.-]&#x27;), -1 * orig.sa_value * t.score) &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  ELSE CONCAT(REGEXP_SUBSTR(orig.sales_amount, &#x27;[^0-9.-]&#x27;), orig.sa_value * t.score) &quot;</span> +</span><br><span class="line">    <span class="string">&quot;END, &quot;</span> +</span><br><span class="line">    <span class="string">&quot;t.gross_profit = CASE &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  WHEN orig.gross_profit REGEXP &#x27;^\\\\(&#x27; THEN CONCAT(REGEXP_SUBSTR(orig.gross_profit, &#x27;[^0-9.-]&#x27;), -1 * orig.gp_value * t.score) &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  ELSE CONCAT(REGEXP_SUBSTR(orig.gross_profit, &#x27;[^0-9.-]&#x27;), orig.gp_value * t.score) &quot;</span> +</span><br><span class="line">    <span class="string">&quot;END, &quot;</span> +</span><br><span class="line">    <span class="string">&quot;t.sales_amount_format = CASE &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  WHEN orig.sales_amount REGEXP &#x27;^\\\\(&#x27; THEN -1 * orig.sa_value * t.score &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  ELSE orig.sa_value * t.score &quot;</span> +</span><br><span class="line">    <span class="string">&quot;END, &quot;</span> +</span><br><span class="line">    <span class="string">&quot;t.gross_profit_format = CASE &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  WHEN orig.gross_profit REGEXP &#x27;^\\\\(&#x27; THEN -1 * orig.gp_value * t.score &quot;</span> +</span><br><span class="line">    <span class="string">&quot;  ELSE orig.gp_value * t.score &quot;</span> +</span><br><span class="line">    <span class="string">&quot;END &quot;</span> +</span><br><span class="line">    <span class="string">&quot;WHERE DATE(t.created_at) = CURDATE();&quot;</span>;</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/%E4%BA%8C%E7%BA%A7%E8%B7%AF%E7%94%B1%E8%AE%BE%E7%BD%AE%E8%BF%87%E7%A8%8B/">二级路由设置过程</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">156</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h4 id="二级路由预计设置过程："   >
          <a href="#二级路由预计设置过程：" class="heading-link"><i class="fas fa-link"></i></a><a href="#二级路由预计设置过程：" class="headerlink" title="二级路由预计设置过程："></a>二级路由预计设置过程：</h4>
      <p>二级路由wan口连接主路由的lan口</p>
<p>然后进入设置页面-外部网络-wan联机类型改成静态IP地址：192.168.101.21</p>
<p>（方便访问）主路由设置界面-高级功能-静态路由-新增</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">规则名称：二级路由</span><br><span class="line">目的地址：192.168.2.0</span><br><span class="line">子网掩码：255.255.255.0</span><br><span class="line">下一跳：192.168.101.21</span><br></pre></td></tr></table></div></figure>


        <h5 id="主路由设置双wan口："   >
          <a href="#主路由设置双wan口：" class="heading-link"><i class="fas fa-link"></i></a><a href="#主路由设置双wan口：" class="headerlink" title="主路由设置双wan口："></a>主路由设置双wan口：</h5>
      <p>将另一根光猫网线接入主路由</p>
<p>基本设置-接口模式-双wan口-保存-重启路由</p>
<p>wan设置-wan2设置：</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PPPoE拨号</span><br><span class="line">用户名：******8</span><br><span class="line">密码：****</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/openpyxl%E5%BA%93%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/">openpyxl库的一些问题</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">830</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h4 id="Openpyxl库的一些问题"   >
          <a href="#Openpyxl库的一些问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#Openpyxl库的一些问题" class="headerlink" title="Openpyxl库的一些问题"></a>Openpyxl库的一些问题</h4>
      <p>在使用openpyxl插入表格的时候，如果插入的当前行下面有合并单元格的话，那插入的行数可能不生效或者融进合并单元格里面没有表现出来。这个这个时候尝试了几种方法解决</p>

        <h5 id="第一种方法："   >
          <a href="#第一种方法：" class="heading-link"><i class="fas fa-link"></i></a><a href="#第一种方法：" class="headerlink" title="第一种方法："></a>第一种方法：</h5>
      <p>在模板文件中提前设置好足够多的待使用的行数，后面就不需要插入新的行，使用现成行即可，等完成插入动作后，再把多余的行数删去。</p>

        <h5 id="优点就是简单方便，缺点就是不够灵活-并且如果删除多余的行-那下面的行如果有合并单元格的话单元格也会失效"   >
          <a href="#优点就是简单方便，缺点就是不够灵活-并且如果删除多余的行-那下面的行如果有合并单元格的话单元格也会失效" class="heading-link"><i class="fas fa-link"></i></a><a href="#优点就是简单方便，缺点就是不够灵活-并且如果删除多余的行-那下面的行如果有合并单元格的话单元格也会失效" class="headerlink" title="优点就是简单方便，缺点就是不够灵活,并且如果删除多余的行,那下面的行如果有合并单元格的话单元格也会失效."></a>优点就是简单方便，缺点就是不够灵活,并且如果删除多余的行,那下面的行如果有合并单元格的话单元格也会失效.</h5>
      
        <h5 id="第二种方法"   >
          <a href="#第二种方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#第二种方法" class="headerlink" title="第二种方法:"></a>第二种方法:</h5>
      <p>先把整个sheet页的单元格都拆开,保存原来的合并区间参数,等插入动作完成后再按照原来的参数恢复</p>

        <h5 id="优点就是思路清晰-缺点就是实际恢复过程复杂-特别在插入行数后-原来保存的合并参数需要结合新的行数调整修改-整体实现起来比较复杂"   >
          <a href="#优点就是思路清晰-缺点就是实际恢复过程复杂-特别在插入行数后-原来保存的合并参数需要结合新的行数调整修改-整体实现起来比较复杂" class="heading-link"><i class="fas fa-link"></i></a><a href="#优点就是思路清晰-缺点就是实际恢复过程复杂-特别在插入行数后-原来保存的合并参数需要结合新的行数调整修改-整体实现起来比较复杂" class="headerlink" title="优点就是思路清晰,缺点就是实际恢复过程复杂,特别在插入行数后,原来保存的合并参数需要结合新的行数调整修改,整体实现起来比较复杂"></a>优点就是思路清晰,缺点就是实际恢复过程复杂,特别在插入行数后,原来保存的合并参数需要结合新的行数调整修改,整体实现起来比较复杂</h5>
      <p>第三种方法:</p>
<p>把下面合并单元格的内容复制到别的sheet页中,等插入行完毕后再把此sheet页的内容完整复制过去,这样需要处理的合并单元格将会大大减少,合并起来也比较快了</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">sheet_invoce = wb[<span class="string">&#x27;发票&#x27;</span>]</span><br><span class="line">start_row = <span class="number">8</span></span><br><span class="line">last = <span class="literal">False</span></span><br><span class="line"><span class="keyword">for</span> fba_number,r_index <span class="keyword">in</span> <span class="built_in">zip</span>(new_fba_sku_packaging_info.keys(), <span class="built_in">range</span>(<span class="built_in">len</span>(new_fba_sku_packaging_info.keys()))):</span><br><span class="line">    <span class="keyword">if</span> r_index == <span class="built_in">len</span>(new_fba_sku_packaging_info.keys()) - <span class="number">1</span>:</span><br><span class="line">        last = <span class="literal">True</span></span><br><span class="line">    new_type_info_list = copy_type_info_list(new_fba_sku_packaging_info[fba_number][<span class="string">&#x27;type_info_list&#x27;</span>])</span><br><span class="line">    <span class="keyword">for</span> type_info, l_index <span class="keyword">in</span> <span class="built_in">zip</span>(new_type_info_list, <span class="built_in">range</span>(<span class="built_in">len</span>(new_type_info_list))):</span><br><span class="line">        <span class="keyword">if</span> l_index == <span class="built_in">len</span>(new_type_info_list) - <span class="number">1</span> <span class="keyword">and</span> last:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            copy_row_with_style_formula_merge_cells(sheet_invoce, start_row, start_row + <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># # 写入数据</span></span><br><span class="line">        sheet_invoce[<span class="string">f&#x27;A<span class="subst">&#123;start_row&#125;</span>&#x27;</span>] = <span class="string">&#x27;N/M&#x27;</span></span><br><span class="line">        sheet_invoce[<span class="string">f&#x27;C<span class="subst">&#123;start_row&#125;</span>&#x27;</span>] = type_info[<span class="string">&#x27;type_name&#x27;</span>]</span><br><span class="line">        sheet_invoce[<span class="string">f&#x27;D<span class="subst">&#123;start_row&#125;</span>&#x27;</span>] = type_info[<span class="string">&#x27;count&#x27;</span>]</span><br><span class="line">        sheet_invoce[<span class="string">f&#x27;F<span class="subst">&#123;start_row&#125;</span>&#x27;</span>] = type_info[<span class="string">&#x27;price_cost&#x27;</span>]</span><br><span class="line">        start_row += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">start_row_new = start_row</span><br><span class="line"><span class="comment">#结尾处理</span></span><br><span class="line"><span class="comment">#复制sheet2内容到发票sheet的结尾</span></span><br><span class="line">sheet2 = wb[<span class="string">&#x27;Sheet2&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制Sheet2的第1-4行到发票sheet的结尾</span></span><br><span class="line"><span class="keyword">for</span> source_row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">    <span class="comment"># 插入新行</span></span><br><span class="line">    sheet_invoce.insert_rows(start_row)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 复制行高</span></span><br><span class="line">    <span class="keyword">if</span> sheet2.row_dimensions[source_row].height:</span><br><span class="line">        sheet_invoce.row_dimensions[start_row].height = sheet2.row_dimensions[source_row].height</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 遍历每一列，复制单元格内容和样式</span></span><br><span class="line">    max_col = sheet2.max_column</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_col + <span class="number">1</span>):</span><br><span class="line">        src_cell = sheet2.cell(row=source_row, column=col)</span><br><span class="line">        dst_cell = sheet_invoce.cell(row=start_row, column=col)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 跳过合并单元格（从单元格，后面统一处理合并区域）</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(src_cell, MergedCell):</span><br><span class="line">            <span class="comment"># 复制值</span></span><br><span class="line">            dst_cell.value = src_cell.value</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 复制样式</span></span><br><span class="line">            <span class="keyword">if</span> src_cell.has_style:</span><br><span class="line">                dst_cell.font = copy(src_cell.font)</span><br><span class="line">                dst_cell.border = copy(src_cell.border)</span><br><span class="line">                dst_cell.fill = copy(src_cell.fill)</span><br><span class="line">                dst_cell.number_format = copy(src_cell.number_format)</span><br><span class="line">                dst_cell.protection = copy(src_cell.protection)</span><br><span class="line">                dst_cell.alignment = copy(src_cell.alignment)</span><br><span class="line"></span><br><span class="line">    start_row += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理合并单元格</span></span><br><span class="line"><span class="comment"># 收集Sheet2中1-4行涉及的合并单元格区域</span></span><br><span class="line">merged_ranges_to_copy = []</span><br><span class="line"><span class="keyword">for</span> merged_range <span class="keyword">in</span> sheet2.merged_cells.ranges:</span><br><span class="line">    <span class="comment"># 检查合并区域是否在1-4行范围内</span></span><br><span class="line">    <span class="keyword">if</span> merged_range.min_row &gt;= <span class="number">1</span> <span class="keyword">and</span> merged_range.max_row &lt;= <span class="number">4</span>:</span><br><span class="line">        merged_ranges_to_copy.append(merged_range)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在发票sheet中创建对应的合并单元格</span></span><br><span class="line"><span class="keyword">for</span> merged_range <span class="keyword">in</span> merged_ranges_to_copy:</span><br><span class="line">    <span class="comment"># 计算新的行位置（从原来的start_row - 4开始）</span></span><br><span class="line">    row_offset = start_row - <span class="number">4</span> - <span class="number">1</span>  <span class="comment"># start_row已经+4了，所以需要-4，再-1因为从第1行开始</span></span><br><span class="line">    new_min_row = merged_range.min_row + row_offset</span><br><span class="line">    new_max_row = merged_range.max_row + row_offset</span><br><span class="line"></span><br><span class="line">    new_range = (</span><br><span class="line">        sheet_invoce.cell(row=new_min_row, column=merged_range.min_col).coordinate</span><br><span class="line">        + <span class="string">&quot;:&quot;</span> +</span><br><span class="line">        sheet_invoce.cell(row=new_max_row, column=merged_range.max_col).coordinate</span><br><span class="line">    )</span><br><span class="line">    sheet_invoce.merge_cells(new_range)</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 设置公式</span></span><br><span class="line">sheet_invoce[<span class="string">f&#x27;C<span class="subst">&#123;start_row_new&#125;</span>&#x27;</span>] = <span class="string">f&#x27;=H<span class="subst">&#123;start_row_new&#125;</span>&#x27;</span></span><br><span class="line">sheet_invoce[<span class="string">f&#x27;H<span class="subst">&#123;start_row_new&#125;</span>&#x27;</span>] = <span class="string">f&#x27;=SUM(H8:H<span class="subst">&#123;start_row_new - <span class="number">1</span>&#125;</span>)&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/AI%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90/">AI工具分析</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">742</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h4 id="1-负责搜索链接，总结分析产品卖点，生产文案"   >
          <a href="#1-负责搜索链接，总结分析产品卖点，生产文案" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-负责搜索链接，总结分析产品卖点，生产文案" class="headerlink" title="1.负责搜索链接，总结分析产品卖点，生产文案"></a>1.负责搜索链接，总结分析产品卖点，生产文案</h4>
      
        <h5 id="免费：-ChatGPT-Gemini-Grok（国内DeepSeek，千问Qwen也可以）"   >
          <a href="#免费：-ChatGPT-Gemini-Grok（国内DeepSeek，千问Qwen也可以）" class="heading-link"><i class="fas fa-link"></i></a><a href="#免费：-ChatGPT-Gemini-Grok（国内DeepSeek，千问Qwen也可以）" class="headerlink" title="免费： ChatGPT/Gemini/Grok（国内DeepSeek，千问Qwen也可以）"></a><strong>免费：</strong> ChatGPT/Gemini/Grok（国内DeepSeek，千问Qwen也可以）</h5>
      <p>复制以下prompt模板，替换店铺链接给AI，让AI分析</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">请分析以下产品链接内容，输出结构化结果：</span><br><span class="line"></span><br><span class="line">【产品链接】</span><br><span class="line">&#123;&#123;product_url&#125;&#125;</span><br><span class="line"></span><br><span class="line">【任务要求】</span><br><span class="line">1. 分析产品的核心卖点（至少 5 点），要求：</span><br><span class="line">   - 每个卖点 1 句话总结 + 简要说明理由</span><br><span class="line">   - 卖点必须基于链接页面内容，而不是凭空编写</span><br><span class="line"></span><br><span class="line">2. 生成可直接用于电商运营的产品文案，包括：</span><br><span class="line">   - 30 字以内短标题（适合主图文字）</span><br><span class="line">   - 80～120 字产品简介（适合详情页开头）</span><br><span class="line">   - 5 条高转化要点文案（bullet points）</span><br><span class="line"></span><br><span class="line">3. 输出适合生成 AI 主图&#x2F;详情图的「图片要点」：</span><br><span class="line">   - 主图应该展示哪些元素？</span><br><span class="line">   - 场景图布局建议？</span><br><span class="line">   - 卖点展示图需要哪些画面？</span><br><span class="line">   - 适合加入哪些文字（例如：耐用 &#x2F; 三层加强 &#x2F; 轻便等）</span><br><span class="line"></span><br><span class="line">【输出格式】</span><br><span class="line">请严格按以下结构输出：</span><br><span class="line"></span><br><span class="line">### 一、产品卖点分析</span><br><span class="line">1.</span><br><span class="line">2.</span><br><span class="line">3.</span><br><span class="line">4.</span><br><span class="line">5.</span><br><span class="line"></span><br><span class="line">### 二、产品文案</span><br><span class="line">- 标题：</span><br><span class="line">- 产品简介：</span><br><span class="line">- 卖点文案：</span><br><span class="line"></span><br><span class="line">### 三、图片要点建议</span><br><span class="line">（主图建议、场景图建议、卖点图建议等）</span><br><span class="line"></span><br><span class="line">如果链接无法正常打开，请提示我。</span><br></pre></td></tr></table></div></figure>


        <h5 id="收费版：writesonic（https-writesonic-com-）"   >
          <a href="#收费版：writesonic（https-writesonic-com-）" class="heading-link"><i class="fas fa-link"></i></a><a href="#收费版：writesonic（https-writesonic-com-）" class="headerlink" title="收费版：writesonic（https://writesonic.com/）"></a><strong>收费版：</strong>writesonic（<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://writesonic.com/%EF%BC%89" >https://writesonic.com/）</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      <p>参考学习教程：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.toolify.ai/zh/ai-news-cn/ai%E9%AB%98%E6%95%88%E7%94%9F%E6%88%90%E7%94%B5%E5%95%86%E4%BA%A7%E5%93%81%E6%8F%8F%E8%BF%B0writesonic%E5%AE%9E%E6%93%8D%E6%95%99%E7%A8%8B-3526900" >https://www.toolify.ai/zh/ai-news-cn/ai%E9%AB%98%E6%95%88%E7%94%9F%E6%88%90%E7%94%B5%E5%95%86%E4%BA%A7%E5%93%81%E6%8F%8F%E8%BF%B0writesonic%E5%AE%9E%E6%93%8D%E6%95%99%E7%A8%8B-3526900</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h4 id="2-图片分析，以图生图"   >
          <a href="#2-图片分析，以图生图" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-图片分析，以图生图" class="headerlink" title="2.图片分析，以图生图"></a>2.图片分析，以图生图</h4>
      <p>普通版：AI模型都可以给提示词生成</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">请分析我提供的产品图片，识别产品类型、材质、颜色和使用方式。</span><br><span class="line">基于原图产品生成新的电商图片，要求：</span><br><span class="line"></span><br><span class="line">【产品保持一致】</span><br><span class="line">- 保持产品主体结构不变</span><br><span class="line">- 保留关键颜色与外形特征</span><br><span class="line">- 不出现品牌、不出现logo</span><br><span class="line"></span><br><span class="line">【图片风格】</span><br><span class="line">- XXX风格（如：极简风 &#x2F; 高级质感 &#x2F; 生活场景 &#x2F; 小清新）</span><br><span class="line">- 背景：XXX（如：白底、厨房场景、户外、桌面摆拍）</span><br><span class="line"></span><br><span class="line">【构图要求】</span><br><span class="line">- 产品居中&#x2F;靠左&#x2F;靠右</span><br><span class="line">- 留白空间，用于文案排版</span><br><span class="line">- 光线柔和、高亮度、商业摄影质感</span><br><span class="line"></span><br><span class="line">【电商平台规则】</span><br><span class="line">- 不违规，不夸张，不使用敏感关键词</span><br><span class="line">- 图片不出现人体敏感部位</span><br><span class="line">- 适配（亚马逊&#x2F;速卖通）主图规范</span><br><span class="line"></span><br><span class="line">【清晰度】</span><br><span class="line">- 高分辨率、4K细节、锐利边缘、无噪点</span><br></pre></td></tr></table></div></figure>


        <h5 id="专业版：Midjourney（https-www-midjourney-com-）"   >
          <a href="#专业版：Midjourney（https-www-midjourney-com-）" class="heading-link"><i class="fas fa-link"></i></a><a href="#专业版：Midjourney（https-www-midjourney-com-）" class="headerlink" title="专业版：Midjourney（https://www.midjourney.com/）"></a>专业版：Midjourney（<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.midjourney.com/%EF%BC%89" >https://www.midjourney.com/）</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      <p>参考Midjourney学习教程：</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/2401_84830464/article/details/138845721" >https://blog.csdn.net/2401_84830464/article/details/138845721</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/Eqiqi/article/details/147983480" >https://blog.csdn.net/Eqiqi/article/details/147983480</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://ai.feishu.cn/wiki/QZl4wqipXi3PF6k1JzIcQ4JYnwh" >https://ai.feishu.cn/wiki/QZl4wqipXi3PF6k1JzIcQ4JYnwh</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h4 id="3-提供产品白底图，AI数字人，生成产品视频"   >
          <a href="#3-提供产品白底图，AI数字人，生成产品视频" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-提供产品白底图，AI数字人，生成产品视频" class="headerlink" title="3.提供产品白底图，AI数字人，生成产品视频"></a>3.提供产品白底图，AI数字人，生成产品视频</h4>
      
        <h5 id="PiPit-AI（https-www-pippit-ai-zh-cn）"   >
          <a href="#PiPit-AI（https-www-pippit-ai-zh-cn）" class="heading-link"><i class="fas fa-link"></i></a><a href="#PiPit-AI（https-www-pippit-ai-zh-cn）" class="headerlink" title="-PiPit AI（https://www.pippit.ai/zh-cn）"></a>-PiPit AI（<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.pippit.ai/zh-cn%EF%BC%89" >https://www.pippit.ai/zh-cn）</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      <p>字节系，集成电商平台，门槛低</p>

        <h5 id="HeyGen-（https-www-heygen-com-zh-cn-video-app-tutorial-generator）"   >
          <a href="#HeyGen-（https-www-heygen-com-zh-cn-video-app-tutorial-generator）" class="heading-link"><i class="fas fa-link"></i></a><a href="#HeyGen-（https-www-heygen-com-zh-cn-video-app-tutorial-generator）" class="headerlink" title="-HeyGen （https://www.heygen.com/zh-cn/video/app-tutorial-generator）"></a>-HeyGen （<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.heygen.com/zh-cn/video/app-tutorial-generator%EF%BC%89" >https://www.heygen.com/zh-cn/video/app-tutorial-generator）</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      <p>质量比较高</p>
<p>教程：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/682336572" >https://zhuanlan.zhihu.com/p/682336572</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/%E8%8B%A5%E4%BE%9D%E5%89%8D%E7%AB%AFVUE%E6%A1%86%E6%9E%B6%E5%87%BA%E7%8E%B0%E7%9A%84BUG%E9%97%AE%E9%A2%98/">若依前端VUE框架出现的BUG问题</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">354</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h4 id="若依前端VUE框架出现的BUG问题"   >
          <a href="#若依前端VUE框架出现的BUG问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#若依前端VUE框架出现的BUG问题" class="headerlink" title="若依前端VUE框架出现的BUG问题"></a>若依前端VUE框架出现的BUG问题</h4>
      <p>在使用过程中有时候会出现切换菜单或者tab标签空白，点击无响应，需要重新刷新后又恢复正常的。这种情况比较偶发，也没有什么报错信息，网上搜下来看挺多人遇到这种问题的，下面分享我使用的解决办法：</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;section class&#x3D;&quot;app-main&quot;&gt;</span><br><span class="line">    &lt;router-view v-slot&#x3D;&quot;&#123; Component, route &#125;&quot;&gt;</span><br><span class="line">      &lt;transition name&#x3D;&quot;fade-transform&quot; mode&#x3D;&quot;out-in&quot;&gt;</span><br><span class="line">        &lt;div :key&#x3D;&quot;route.path&quot;&gt;</span><br><span class="line">        &lt;keep-alive :include&#x3D;&quot;tagsViewStore.cachedViews&quot;&gt;</span><br><span class="line">          &lt;component v-if&#x3D;&quot;!route.meta.link&quot; :is&#x3D;&quot;Component&quot; :key&#x3D;&quot;route.fullPath&quot;&#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;keep-alive&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;&#x2F;transition&gt;</span><br><span class="line">    &lt;&#x2F;router-view&gt;</span><br><span class="line">    &lt;iframe-toggle &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;section&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></div></figure>

<p>主要还是出现在AppMain.vue上，需要在keep-alive上加一个div，这样子就能解决切换标签页面无响应的问题了，貌似还可以可以把transition去掉，需要的也可以尝试一下：</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;section class&#x3D;&quot;app-main&quot;&gt;</span><br><span class="line">    &lt;router-view v-slot&#x3D;&quot;&#123; Component, route &#125;&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;keep-alive :include&#x3D;&quot;tagsViewStore.cachedViews&quot;&gt;</span><br><span class="line">          &lt;component v-if&#x3D;&quot;!route.meta.link&quot; :is&#x3D;&quot;Component&quot; :key&#x3D;&quot;route.fullPath&quot;&#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;keep-alive&gt;</span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;router-view&gt;</span><br><span class="line">    &lt;iframe-toggle &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;section&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/">用selenium登录获取cookie后，需要留意跨域问题</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">205</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h4 id="用selenium登录获取cookie后，需要留意跨域问题"   >
          <a href="#用selenium登录获取cookie后，需要留意跨域问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#用selenium登录获取cookie后，需要留意跨域问题" class="headerlink" title="用selenium登录获取cookie后，需要留意跨域问题"></a>用selenium登录获取cookie后，需要留意跨域问题</h4>
      <p>在赋值cookie时需要把cookie的跨域修改，修改内容如下：</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cookies = driver.get_cookies()</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    <span class="keyword">for</span> cookie <span class="keyword">in</span> cookies:</span><br><span class="line">        <span class="comment"># 移除selenium特定的属性，保留requests需要的属性</span></span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> [<span class="string">&#x27;expiry&#x27;</span>, <span class="string">&#x27;sameSite&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>,<span class="string">&#x27;PHPSESSID&#x27;</span>]:</span><br><span class="line">            cookie.pop(key, <span class="literal">None</span>)</span><br><span class="line">        <span class="comment"># 强制覆盖 domain 和 path，确保支持跨子域访问</span></span><br><span class="line">        cookie[<span class="string">&#x27;domain&#x27;</span>] = <span class="string">&#x27;.mabangerp.com&#x27;</span></span><br><span class="line">        cookie[<span class="string">&#x27;path&#x27;</span>] = <span class="string">&#x27;/&#x27;</span></span><br><span class="line">        session.cookies.<span class="built_in">set</span>(**cookie)</span><br><span class="line">        <span class="built_in">print</span>(cookie)</span><br><span class="line"></span><br><span class="line">    response = session.get(<span class="string">&quot;https://aamz.mabangerp.com/index.php?mod=mainpage.index&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(response.headers.get(<span class="string">&#x27;Set-Cookie&#x27;</span>))</span><br></pre></td></tr></table></div></figure>

<p>以上的cookie设置不止是跨域问题，还有后面想要达到导出文件的目的话，要先把PHPSESSID给删掉，后面再去访问aamz子域马帮接口才能够正确访问，而不会出现companyId未设置的错误</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/%E9%80%9F%E5%8D%96%E9%80%9A%E7%88%AC%E8%99%AB%E7%99%BB%E5%BD%95%E5%BC%B9%E7%AA%97%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">速卖通爬虫登录弹窗解决办法</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">461</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="速卖通爬虫登录弹窗解决办法"   >
          <a href="#速卖通爬虫登录弹窗解决办法" class="heading-link"><i class="fas fa-link"></i></a><a href="#速卖通爬虫登录弹窗解决办法" class="headerlink" title="速卖通爬虫登录弹窗解决办法"></a>速卖通爬虫登录弹窗解决办法</h3>
      <p>速卖通每天登录需要点击弹窗，并且弹窗内容样式不一样，虽然可以退出浏览器再重新登录后让此弹窗消失，但始终治标不治本。现在采取的方式就是爬虫启动时，也另起一个线程运行css样式注入+DOM删除双管齐下，让弹窗的样式消失，具体的代码如下：</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">popup_cleaner</span>(<span class="params">driver, interval=<span class="number">2</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;守护线程，定时删除弹窗（CSS隐藏 + DOM删除）&quot;&quot;&quot;</span></span><br><span class="line">    js_code = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    if (!document.getElementById(&#x27;hide-ppp-style&#x27;)) &#123;</span></span><br><span class="line"><span class="string">        const style = document.createElement(&#x27;style&#x27;);</span></span><br><span class="line"><span class="string">        style.id = &#x27;hide-ppp-style&#x27;;</span></span><br><span class="line"><span class="string">        style.textContent = `</span></span><br><span class="line"><span class="string">        .next-overlay-wrapper.ppp-overlay-wrapper.opened &#123;display:none !important;&#125;</span></span><br><span class="line"><span class="string">        .box-guide-page-mask &#123;display:none !important;&#125;</span></span><br><span class="line"><span class="string">        .next-overlay-wrapper.opened &#123;display:none !important;&#125;</span></span><br><span class="line"><span class="string">        .next-overlay-inner.next-dialog-wrapper.next-dialog-centered &#123;display:none !important;&#125;</span></span><br><span class="line"><span class="string">        .next-overlay-backdrop &#123;display:none !important;&#125;</span></span><br><span class="line"><span class="string">        `;</span></span><br><span class="line"><span class="string">        document.head.appendChild(style);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    js_code_remove = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    const selectors = [</span></span><br><span class="line"><span class="string">        &#x27;.next-overlay-wrapper.ppp-overlay-wrapper.opened&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;.box-guide-page-mask&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;.next-overlay-wrapper.opened&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;.next-overlay-inner.next-dialog-wrapper.next-dialog-centered&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;.next-overlay-backdrop&#x27;</span></span><br><span class="line"><span class="string">    ];</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    let removedCount = 0;</span></span><br><span class="line"><span class="string">    selectors.forEach(selector =&gt; &#123;</span></span><br><span class="line"><span class="string">        const elements = document.querySelectorAll(selector);</span></span><br><span class="line"><span class="string">        elements.forEach(el =&gt; &#123;</span></span><br><span class="line"><span class="string">            el.remove();</span></span><br><span class="line"><span class="string">            removedCount++;</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    return removedCount;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            driver.execute_script(js_code)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;注入CSS成功&quot;</span>)</span><br><span class="line"></span><br><span class="line">            removed_count = driver.execute_script(js_code_remove)</span><br><span class="line">            <span class="keyword">if</span> removed_count &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;删除弹窗元素成功，共删除 <span class="subst">&#123;removed_count&#125;</span> 个元素&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;未发现需要删除的弹窗元素&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;执行弹窗清理失败，将退出守护线程&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span>  <span class="comment"># driver 已关闭，退出守护线程</span></span><br><span class="line">        time.sleep(interval)</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>为了绕过网址的注入防御，需要用style.textContent。主要的原理就是循环注入CSS+DOM删除，防止速卖通随机出现弹窗，只要获得样式就能解决，不用每次都新增一条xpath代码了。</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2026/02/02/%E9%80%9F%E5%8D%96%E9%80%9Asign%E9%80%86%E5%90%91/">速卖通sign逆向</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon" data-popover="发表时间" data-popover-pos="up"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon" data-popover="修改时间" data-popover-pos="up"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__value">2026-02-02</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon" data-popover="字数统计" data-popover-pos="up"><i class="far fa-file-word"></i></span><span class="post-meta-item__value">34</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="速卖通sign逆向"   >
          <a href="#速卖通sign逆向" class="heading-link"><i class="fas fa-link"></i></a><a href="#速卖通sign逆向" class="headerlink" title="速卖通sign逆向"></a>速卖通sign逆向</h3>
      <p>速卖通sign提取步骤：<br>关键字：d.token<br>关键片段： k = i(d.token + “&amp;” + j + “&amp;” + h + “&amp;” + c.data)</p>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://avatars.githubusercontent.com/u/51011931?v=4" alt="avatar"></div><p class="sidebar-ov-author__text">吃饭叫我</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/sean-wq" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">27</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">7</div><div class="sidebar-ov-state-item__name">分类</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">47</div><div class="sidebar-ov-state-item__name">标签</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2026</span><span class="footer__devider"></span><span>Sean</span></div><div class="busuanzi"></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="搜索文章（支持多关键词，请用空格分隔）"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/ribbon.js@latest/dist/ribbon.min.js" size="120" alpha="0.6" zIndex="-1"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.json';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // 将 XML 转为 JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // 搜索对象（标题、内容）的权重，影响显示顺序
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // 根据空白字符分隔关键字
        var keywords = searchText.split(/[\s]+/);
        // 搜索结果
        var matchPosts = [];

        // 有多个关键字时，将原文字整个保存下来
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // 防止未输入字符时搜索
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // 没有标题的文章使用预设的 i18n 变量代替
            var title = (data.title && data.title.trim()) || '[ 文章无标题 ]';
            var titleLower = title && title.toLowerCase();
            // 删除 HTML 标签 和 所有空白字符
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // 删除重复的 /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // 标题中匹配到的关键词
            var titleHitSlice = [];
            // 内容中匹配到的关键词
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * 获取匹配的关键词的索引
              * @param {String} keyword 要匹配的关键字
              * @param {String} text 原文字
              * @param {Boolean} caseSensitive 是否区分大小写
              * @param {Number} weight 匹配对象的权重。权重大的优先显示
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // 每次匹配的开始索引
                var index = -1;     // 匹配到的索引值
                var result = [];    // 匹配结果

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // 索引位置相同的关键词，保留长度较长的
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // 按照匹配文字的索引的递增顺序排序
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * 给文本中匹配到的关键词添加标记，从而进行高亮显示
              * @param {String} text 原文本
              * @param {Array} hitSlice 匹配项的索引信息
              * @param {Number} start 开始索引
              * @param {Number} end 结束索引
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // 文章总的搜索权重
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // 标记匹配关键词后的标题
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // 标记匹配关键词后的内容
              var postContent;
              // 显示内容的长度
              var SHOW_WORD_LENGTH = 200;
              // 命中关键词前的字符显示长度
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // 截取匹配的第一个字符，前后共 200 个字符来显示
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // 未匹配到内容，直接截取前 200 个字符来显示
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // 按权重递增的顺序排序，使权重大的优先显示
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);

function safeOpenUrl(url) {
  var newTab = window.open();
  newTab.opener = null;
  newTab.location = url;
}

function extSearch(engine) {
  var engines = {
    google: 'https://www.google.com/search?q=',
    bing: 'https://cn.bing.com/search?q=',
    baidu: 'https://www.baidu.com/s?ie=UTF-8&wd=',
  };
  var host = window.location.host;
  var query = $('.search-input input').val().toLowerCase().trim();
  var uri = engines[engine] + query + ' site:' + host;

  if (query) {
    safeOpenUrl(uri);
  } else {
    Stun.utils.popAlert('warning', '请输入字符');
  }
}

var assistSearchList = window.CONFIG.assistSearch;

if (Array.isArray(assistSearchList)) {
  assistSearchList.forEach(function (name) {
    document.querySelector('.search-btns-item--' + name).addEventListener('click', function () {
      extSearch(name);
    }, false);
  });
}</script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script><script type="application/json" src="/search.json"></script></body></html>